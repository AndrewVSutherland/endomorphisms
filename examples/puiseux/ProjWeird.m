F := Rationals(); K := F;
R<x> := PolynomialRing(F);
fX := x^6 + 84*x^5 + 4876*x^4 + 163296*x^3 + 8726544/7*x^2 - 20500672*x + 10355021120/49;
fX := R ! (x^6*Evaluate(fX, 1/x));
X := HyperellipticCurve(fX);
fY := x^3 - 959512576/21*x + 170900703936512/1323;
fY := x^3 + 53917788955420250865664/2401;
Y := HyperellipticCurve(fY);

R<x,y> := PolynomialRing(K, 2);
fs := [
    (10096/3*x^2 + 112*x + 4)/x^2,
    8*y/x^3
];
fs := [
    (2357706799/872863004640*x^5 + 161979533/1745726009280*x^4 -
        4408033/1745726009280*x^3 + 111313/6982904037120*x^2*y +
        3200657/3491452018560*x^2 + 146167/6982904037120*x*y +
        146167/2793161614848*x + 20881/27931616148480*y +
        20881/27931616148480)/(x^5 - 1643688637/3156012930*x^4 -
        7045913/450858990*x^3 + 11503/90171798*x^2*y + 4798537/901717980*x^2 -
        2639/450858990*x*y + 220031/721374384*x - 377/1803435960*y +
        31433/7213743840),
    (169887941302751/44770333601912503664640*x^5 -
        106973060584163/89540667203825007329280*x^4 -
        345475388417873/89540667203825007329280*x^3 -
        3030113194549/71632533763060005863424*x^2*y -
        23755936521023/179081334407650014658560*x^2 -
        364344856729/358162668815300029317120*x*y -
        329920608409/143265067526120011726848*x -
        43853015647/1432650675261200117268480*y -
        43853015647/1432650675261200117268480)/(x^5 +
        619609171637/47779281642639360*x^2*y - 39691792735/3185285442842624*x*y
        - 240052215/411004573270016*y + 157/1699681888)
];
fs := [ 1/fs[2], fs[1]/fs[2]^2 ];
fX := R ! DefiningEquation(AffinePatch(X, 1)); fY := R ! DefiningEquation(AffinePatch(Y, 1));
IX := ideal<R | fX>;
print "Well-defined?", R ! Numerator(Evaluate(R ! fY, fs)) in IX;

AX := AffinePatch(X, 1); AY := AffinePatch(Y, 1);
KX := FunctionField(AX); KY := FunctionField(AY);
m := map<AX -> AY | fs >;
print "Degree:", Degree(ProjectiveClosure(m));

exit;
